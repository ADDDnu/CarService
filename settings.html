
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Car Service ¬∑ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="logo.png">
  <link rel="stylesheet" href="style.css" />
  <script src="app.js" defer></script>
</head>
<body class="has-tabbar" onload="renderSettings()">
  <header>
    <img src="logo.png" alt="Car Service Logo" class="logo">
    <h1>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h1>
  </header>

  <main>
    <form onsubmit="saveSettings(event)">
      <label>MQTT WebSocket URL</label>
      <input type="text" id="cfg_mqtt_url" placeholder="ws://172.16.18.200:9001" />

      <label>MQTT Username</label>
      <input type="text" id="cfg_mqtt_user" placeholder="mqttadmin" />

      <label>MQTT Password</label>
      <input type="password" id="cfg_mqtt_pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />

      <button type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
    </form>

    <hr/>
    <h3>‡∏ô‡∏≥‡∏≠‡∏≠‡∏Å / ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
    <div class="stat-card" style="flex-direction:column;align-items:flex-start">
      <div>
        <button onclick="exportData()">‚¨áÔ∏è Export (.json)</button>
      </div>
      <div>
        <label style="margin-top:12px">Import (.json):</label>
        <input type="file" id="import_file" accept="application/json" />
      </div>
    </div>
  
    <hr/>
    <h3>‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô / ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h3>
    <div class="stat-card" style="flex-direction:column;align-items:flex-start">
      <button onclick="restoreFromBackup()">‚ôªÔ∏è ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å backup ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</button>
      <label style="margin-top:12px">‡∏ß‡∏≤‡∏á JSON ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤:</label>
      <textarea id="paste_json" rows="6" style="width:100%;font-family:ui-monospace,Consolas,monospace"></textarea>
      <div><button onclick="importFromTextarea()">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button></div>
    </div>

  
    <hr/>
    <h3>‡∏™‡∏≥‡∏£‡∏≠‡∏á/‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏ú‡πà‡∏≤‡∏ô Google Drive</h3>
    <div class="stat-card" style="flex-direction:column;align-items:flex-start">
      <label>Google API Key</label>
      <input type="text" id="gapi_key" placeholder="AIza... (API Key)" />
      <label>OAuth Client ID</label>
      <input type="text" id="gapi_client" placeholder="1234567890-xxxx.apps.googleusercontent.com" />
      <label>‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ö‡∏ô Drive</label>
      <input type="text" id="gdrive_filename" placeholder="car_service_backup.json" />

      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
        <button type="button" onclick="saveDriveCfg()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏µ‡∏¢‡πå</button>
        <button type="button" onclick="gdriveSignIn()">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ Google</button>
        <button type="button" onclick="gdriveSignOut()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        <span id="gdrive_status" style="align-self:center;color:#666">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
      </div>

      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
        <button type="button" onclick="gdriveBackup()">‚¨ÜÔ∏è ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô Drive</button>
        <button type="button" onclick="gdriveRestore()">‚¨áÔ∏è ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å Drive</button>
      </div>
      <p style="font-size:12px;color:#666;margin-top:8px">
        * ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ <b>Google API Key</b> ‡πÅ‡∏•‡∏∞ <b>OAuth Client ID</b> (OAuth type: Web) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô Authorized JavaScript origins
      </p>
    </div>

  </main>

  <div id="tabbar">
    <nav class="tabbar">
      <a href="index.html"><span class="icon">üè†</span><span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></a>
      <a href="cars.html"><span class="icon">üöó</span><span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ñ</span></a>
      <a href="add.html"><span class="icon">üìù</span><span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span></a>
      <a href="settings.html" class="active"><span class="icon">‚öôÔ∏è</span><span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span></a>
    </nav>
  </div>
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="drive.js"></script>

  <script>
    (function(){
      try{
        const cfg = JSON.parse(localStorage.getItem('gdrive_cfg')||'{}');
        if (cfg.apiKey) document.getElementById('gapi_key').value = cfg.apiKey;
        if (cfg.clientId) document.getElementById('gapi_client').value = cfg.clientId;
        if (cfg.filename) document.getElementById('gdrive_filename').value = cfg.filename;
      }catch(e){}
      if (window.updateGdriveUI) setTimeout(updateGdriveUI, 600);
    })();
  </script>
</body>

</html>
